<div class="search-users">
  <h2>Search Users</h2>
  <form method="GET" action="/main">
    <input type="text" placeholder="Search..." name="q">
    <button type="submit">Go</button>
  </form>
  <% if (users && users.length > 0) { %>
    <h2>Search Results:</h2>
    <ul>
      <% users.forEach(function(user) { %>
        <li>
          <%= user.username %>
          <% if (currentUser && currentUser._id && user._id && currentUser._id.toString() !== user._id.toString()) { %>
            <% if (currentUser.following && currentUser.following.includes(user._id)) { %>
              <button disabled>Following</button>
            <% } else { %>
              <form method="POST" action="/follow">
                <input type="hidden" name="userId" value="<%= user._id %>">
                <button type="submit">Follow</button>
              </form>
            <% } %>
          <% } %>
        </li>
      <% }); %>
    </ul>
  <% } else if (query) { %>
    <p>No users found.</p>
  <% } %>
</div>